<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confucian Café · React UI Mockup</title>
    <style>
        :root {
            --chinese-red: #8B0000;
            --chinese-gold: #FFD700;
            --paper-beige: #F5F5DC;
            --light-cream: #FFFEF0;
            --ink-black: #1a1a1a;
            --level-1: #8B0000;
            --level-2: #B71C1C;
            --level-3: #555555;
            --level-4: #777777;
            --jade: #00A86B;
            --soft-white: rgba(255, 255, 255, 0.94);
            --border: rgba(139, 0, 0, 0.16);
            --code-bg: rgba(0, 0, 0, 0.08);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: linear-gradient(135deg, var(--paper-beige) 0%, var(--light-cream) 100%);
            color: var(--ink-black);
            margin: 0;
            padding: 0 0 60px 0;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro', 'Segoe UI', Roboto, Arial, sans-serif;
            font-size: 14px;
            line-height: 1.4;
        }

        .container {
            width: min(1180px, 96vw);
            margin: 24px auto;
            display: grid;
            gap: 22px;
        }

        h1 {
            font-size: 34px;
            font-weight: 900;
            letter-spacing: -0.5px;
            text-align: center;
            background: linear-gradient(135deg, var(--chinese-red), #CD5C5C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        h2 {
            font-size: 21px;
            font-weight: 700;
            color: var(--level-1);
            border-left: 4px solid var(--chinese-red);
            padding-left: 12px;
            background: rgba(139, 0, 0, 0.05);
        }

        h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--level-2);
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 6px;
        }

        p, li, span { color: var(--level-3); }

        .important {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 255, 255, 0.92));
            border: 2px solid var(--chinese-gold);
            border-radius: 6px;
            padding: 18px;
            display: grid;
            gap: 10px;
        }

        .important ul { list-style: none; display: grid; gap: 8px; }

        .two-column {
            display: grid;
            grid-template-columns: 340px 1fr;
            gap: 18px;
        }

        .panel {
            background: var(--soft-white);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 16px;
            box-shadow: 0 8px 30px rgba(26, 26, 26, 0.08);
            display: grid;
            gap: 14px;
        }

        .code-block {
            background: var(--code-bg);
            border-radius: 6px;
            padding: 12px;
            overflow-x: auto;
            font-family: 'SF Mono', 'Roboto Mono', Menlo, Courier, monospace;
            font-size: 12.6px;
            line-height: 1.45;
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(139, 0, 0, 0.1);
            border: 1px solid rgba(139, 0, 0, 0.18);
            font-size: 11px;
            font-weight: 600;
            color: var(--level-2);
            user-select: none;
        }

        .grid {
            display: grid;
            gap: 12px;
        }

        .component-card {
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 12px 14px;
            background: rgba(255, 255, 255, 0.9);
            display: grid;
            gap: 6px;
        }

        .layout-diagram {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .layout-diagram .box {
            border: 1px dashed rgba(139, 0, 0, 0.25);
            border-radius: 6px;
            padding: 10px;
            display: grid;
            gap: 4px;
            background: rgba(139, 0, 0, 0.04);
        }

        .table {
            border-collapse: collapse;
            width: 100%;
        }

        .table th, .table td {
            border: 1px solid rgba(139, 0, 0, 0.2);
            padding: 8px 10px;
            text-align: left;
            background: rgba(255, 255, 255, 0.92);
        }

        .table th { background: rgba(139, 0, 0, 0.08); color: var(--level-2); font-weight: 700; }

        footer {
            text-align: center;
            padding: 20px;
            background: rgba(139, 0, 0, 0.08);
            border-radius: 6px;
            font-weight: 600;
            color: var(--level-2);
        }

        @media (max-width: 1080px) {
            .two-column { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Confucian Café · React UI Mockup</h1>

        <section class="important">
            <h2>Design Snapshot</h2>
            <ul>
                <li><strong>Componentized layout:</strong> roster, dialogue stream, and control drawer broken into reusable React components.</li>
                <li><strong>English-first rendering:</strong> translations and insights mount only when toggles flip or payloads arrive.</li>
                <li><strong>Config-driven philosophers:</strong> mock payloads show how roster pills update session state without code edits.</li>
                <li><strong>Mock SSE events:</strong> sample stream demonstrates translation fetches and user prompt routing.</li>
                <li><strong>Single-page shell:</strong> everything lives inside one React tree that can drop into Next.js, Vite, or CRA.</li>
            </ul>
        </section>

        <section class="panel">
            <h2>Component Layout</h2>
            <div class="layout-diagram">
                <div class="box">
                    <strong><code>&lt;App&gt;</code></strong>
                    <span class="badge">Grid · 3 columns</span>
                    <span>Provides context + mock SSE.</span>
                </div>
                <div class="box">
                    <strong><code>&lt;PhilosopherRoster&gt;</code></strong>
                    <span>Toggle agents · show persona cards.</span>
                </div>
                <div class="box">
                    <strong><code>&lt;DialogueStream&gt;</code></strong>
                    <span>Renders messages, translations on demand, timeline, prompt composer.</span>
                </div>
                <div class="box">
                    <strong><code>&lt;SessionControlDrawer&gt;</code></strong>
                    <span>Language defaults, insights switch, event feed.</span>
                </div>
            </div>
        </section>

        <section class="two-column">
            <div class="panel">
                <h2>Mock Data · <code>mockPayloads.ts</code></h2>
                <div class="code-block">
{`export const mockPhilosophers = [
  {
    id: 'confucius',
    name: 'Confucius',
    school: '儒家',
    port: 8001,
    showThoughts: true,
    personaSummary: 'Focus on ren 仁 and li 礼 to coordinate duty.',
    skills: ['share_position', 'critique', 'find_synthesis'],
  },
  {
    id: 'laozi',
    name: 'Laozi',
    school: '道家',
    port: 8002,
    showThoughts: false,
    personaSummary: 'Wu wei 无为; soften authority, guide like water.',
    skills: ['share_position', 'reframe'],
  },
  {
    id: 'mozi',
    name: 'Mozi',
    school: '墨家',
    port: 8003,
    showThoughts: true,
    personaSummary: 'Measure benefit; universal care over ritual.',
    skills: ['share_position', 'audit_policy'],
  },
];

export const mockDialogueEvents = [
  {
    id: 'evt-01',
    type: 'message',
    phase: 'introduce',
    timestamp: '2025-10-05T09:00:00Z',
    speaker: 'confucius',
    surface: 'A stable river requires ritual order... ',
    translations: {},
    insight: 'Link li 礼 to practical duty; expect Mozi to push utility.',
  },
  {
    id: 'evt-01a',
    type: 'translation',
    parentId: 'evt-01',
    language: 'modern',
    text: '河水要稳，需礼制齐备，让乡里各司其职守望。'
  },
  {
    id: 'evt-02',
    type: 'message',
    phase: 'introduce',
    timestamp: '2025-10-05T09:02:00Z',
    speaker: 'laozi',
    surface: 'Let the water wander within soft banks...',
    translations: {},
  },
  {
    id: 'evt-03',
    type: 'message',
    phase: 'introduce',
    timestamp: '2025-10-05T09:04:00Z',
    speaker: 'mozi',
    surface: 'Count the benefit: evacuate first...',
    translations: {},
    insight: 'Prioritize measurable benefit; note ritual delays.',
  },
  {
    id: 'evt-04',
    type: 'phase-change',
    phase: 'cross-response',
    timestamp: '2025-10-05T09:05:30Z'
  },
];

export const mockSessionState = {
  topic: 'Water Control Ethics',
  date: '2025-10-05',
  activePhilosophers: ['confucius', 'laozi', 'mozi'],
  languageDefaults: { english: true, modern: false, classical: false },
  showInsights: true,
};
`}
                </div>
            </div>

            <div class="panel">
                <h2>Mock SSE Feed · <code>useMockStream.ts</code></h2>
                <div class="code-block">
{`import { useEffect } from 'react';
import { mockDialogueEvents } from './mockPayloads';

export function useMockStream(onEvent: (evt: DialogueEvent) => void) {
  useEffect(() => {
    const timeouts = mockDialogueEvents.map((evt, index) =>
      setTimeout(() => onEvent(evt), (index + 1) * 800)
    );
    return () => timeouts.forEach(clearTimeout);
  }, [onEvent]);
}
`}
                </div>
                <p>This hook simulates SSE by firing successive events. Swap in `EventSource` when wiring up the real backend.</p>
            </div>
        </section>

        <section class="panel">
            <h2>React Component Skeleton</h2>
            <div class="code-block">
{`import { useMemo, useState, useCallback } from 'react';
import {
  mockPhilosophers,
  mockSessionState,
} from './mockPayloads';
import { useMockStream } from './useMockStream';

export function App() {
  const [activeIds, setActiveIds] = useState(mockSessionState.activePhilosophers);
  const [languageDefaults, setLanguageDefaults] = useState(mockSessionState.languageDefaults);
  const [showInsights, setShowInsights] = useState(mockSessionState.showInsights);
  const [messages, setMessages] = useState<DialogueMessage[]>([]);

  const roster = useMemo(
    () => mockPhilosophers.filter(p => activeIds.includes(p.id)),
    [activeIds]
  );

  const handleStreamEvent = useCallback((evt: DialogueEvent) => {
    setMessages(prev => mergeEvent(prev, evt));
  }, []);

  useMockStream(handleStreamEvent);

  return (
    <div className="app-grid">
      <PhilosopherRoster
        roster={mockPhilosophers}
        activeIds={activeIds}
        onToggle={id => toggleId(id, setActiveIds)}
      />

      <DialogueStream
        topic={mockSessionState.topic}
        date={mockSessionState.date}
        messages={messages}
        roster={roster}
        languageDefaults={languageDefaults}
        showInsights={showInsights}
        onLanguageRequest={(id, lang) => requestTranslation(id, lang, setMessages)}
        onSendPrompt={payload => console.log('prompt →', payload)}
      />

      <SessionControlDrawer
        languageDefaults={languageDefaults}
        onLanguageDefaultsChange={setLanguageDefaults}
        showInsights={showInsights}
        onToggleInsights={setShowInsights}
        eventLog={messages.slice(-6)}
      />
    </div>
  );
}
`}
            </div>
        </section>

        <section class="panel">
            <h2>Key Child Components</h2>
            <div class="grid">
                <div class="component-card">
                    <h3><code>&lt;PhilosopherRoster /&gt;</code></h3>
                    <p>Renders toggle pills plus detail cards for each active philosopher.</p>
                    <div class="code-block">
{`function PhilosopherRoster({ roster, activeIds, onToggle }: RosterProps) {
  return (
    <aside className="panel roster">
      <header>
        <h3>Philosopher Lineup</h3>
        <span className="badge">Session: Autumn Seminar 2025</span>
      </header>
      <div className="toggle-bar">
        {roster.map(philosopher => (
          <button
            key={philosopher.id}
            className={clsx('pill', activeIds.includes(philosopher.id) && 'active')}
            onClick={() => onToggle(philosopher.id)}
          >
            {philosopher.name}
          </button>
        ))}
      </div>
      {roster
        .filter(p => activeIds.includes(p.id))
        .map(p => (
          <div key={p.id} className="card">
            <header>
              <strong>{p.name}</strong>
              <span className="pill">{p.school} · port {p.port}</span>
            </header>
            <p>{p.personaSummary}</p>
            <div className="skill-list">
              {p.skills.map(skill => (
                <span key={skill}>{skill}</span>
              ))}
            </div>
            {p.showThoughts && <span className="pill highlight">Insights enabled</span>}
          </div>
        ))}
    </aside>
  );
}
`}
                    </div>
                </div>

                <div class="component-card">
                    <h3><code>&lt;DialogueStream /&gt;</code></h3>
                    <p>Central canvas: shows messages, translation buttons, timeline, and composer.</p>
                    <div class="code-block">
{`function DialogueStream({
  topic,
  date,
  messages,
  roster,
  languageDefaults,
  showInsights,
  onLanguageRequest,
  onSendPrompt,
}: DialogueProps) {
  const [prompt, setPrompt] = useState('');
  const [audience, setAudience] = useState<'all' | PhilosopherId>('all');

  return (
    <section className="panel dialogue">
      <header className="dialogue-header">
        <div>
          <h3>Dialogue Stream</h3>
          <span className="pill">Topic: {topic} · {date}</span>
        </div>
        <LanguageChips defaults={languageDefaults} />
      </header>

      <ol className="message-list">
        {messages.map(msg => (
          <MessageCard
            key={msg.id}
            message={msg}
            philosopher={roster.find(p => p.id === msg.speaker)}
            showInsights={showInsights && roster.find(p => p.id === msg.speaker)?.showThoughts}
            onLanguageRequest={onLanguageRequest}
          />
        ))}
      </ol>

      <TimelineStrip currentPhase={findCurrentPhase(messages)} />

      <PromptComposer
        prompt={prompt}
        onPromptChange={setPrompt}
        audience={audience}
        onAudienceChange={setAudience}
        onSubmit={() => {
          if (!prompt.trim()) return;
          onSendPrompt({ prompt, audience });
          setPrompt('');
        }}
      />
    </section>
  );
}
`}
                    </div>
                </div>

                <div class="component-card">
                    <h3><code>&lt;MessageCard /&gt;</code></h3>
                    <p>Handles English-first rendering and on-demand translations.</p>
                    <div class="code-block">
{`function MessageCard({ message, philosopher, showInsights, onLanguageRequest }: MessageCardProps) {
  const [expanded, setExpanded] = useState<{ [lang in DialogueLanguage]?: boolean }>({});

  const handleToggle = (lang: DialogueLanguage) => {
    if (!expanded[lang]) {
      onLanguageRequest(message.id, lang);
    }
    setExpanded(prev => ({ ...prev, [lang]: !prev[lang] }));
  };

  return (
    <li className="message">
      <div className="meta">
        <span>
          {philosopher?.name ?? message.speaker} · {formatPhase(message.phase)} · {formatTime(message.timestamp)}
        </span>
        <span className="pill">EN surface</span>
      </div>
      <p>{message.surface}</p>
      <div className="controls">
        <button onClick={() => handleToggle('modern')} className="ghost-button">
          {expanded.modern ? 'Hide Modern' : 'Show Modern Chinese'}
        </button>
        <button onClick={() => handleToggle('classical')} className="ghost-button secondary">
          {expanded.classical ? 'Hide Classical' : 'Show Classical'}
        </button>
      </div>
      {expanded.modern && message.translations?.modern && (
        <TranslationBlock language="modern" text={message.translations.modern} />
      )}
      {expanded.classical && message.translations?.classical && (
        <TranslationBlock language="classical" text={message.translations.classical} />
      )}
      {showInsights && message.insight && (
        <details className="insight" open>
          <summary>Internal thoughts</summary>
          <p>{message.insight}</p>
        </details>
      )}
    </li>
  );
}
`}
                    </div>
                </div>
            </div>
        </section>

        <section class="panel">
            <h2>Event & Prompt Handling (Mock)</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>Payload Type</th>
                        <th>Example</th>
                        <th>UI Reaction</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>message</code></td>
                        <td><code>{`{ speaker: 'confucius', surface: 'A stable river...', phase: 'introduce' }`}</code></td>
                        <td>Append English card to stream.</td>
                    </tr>
                    <tr>
                        <td><code>translation</code></td>
                        <td><code>{`{ parentId: 'evt-01', language: 'modern', text: '河水要稳…' }`}</code></td>
                        <td>Store in card → reveal when user toggles language.</td>
                    </tr>
                    <tr>
                        <td><code>insight</code></td>
                        <td><code>{`{ parentId: 'evt-03', insight: 'Prioritize measurable benefit' }`}</code></td>
                        <td>Show in accordion if insights toggled on.</td>
                    </tr>
                    <tr>
                        <td><code>phase-change</code></td>
                        <td><code>{`{ phase: 'cross-response' }`}</code></td>
                        <td>Highlight timeline segment; update event feed.</td>
                    </tr>
                    <tr>
                        <td><code>user-prompt</code></td>
                        <td><code>{`{ prompt: 'Budget impact?', audience: 'mozi' }`}</code></td>
                        <td>Push to moderator; optionally display in event feed.</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="panel">
            <h2>Styling Notes</h2>
            <ul>
                <li>Semantic class names (`panel`, `pill`, `message-list`) keep styling portable to CSS Modules, Tailwind, or vanilla CSS.</li>
                <li>All colors come from CSS variables; dropping into Chakra/Material UI just means mapping tokens.</li>
                <li>ARIA-friendly translation buttons & details tags ensure screen readers announce when extra language content loads.</li>
                <li>Autocompact can run behind `mergeEvent` helper to prune old text while keeping local state minimal.</li>
            </ul>
        </section>

        <footer>
            This mockup gives you ready-to-drop React components, mock payloads, and stream utilities—wire to real SSE and A2A agents when you’re ready.
        </footer>
    </div>
</body>
</html>
